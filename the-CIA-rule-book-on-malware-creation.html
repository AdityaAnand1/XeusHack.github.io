<!DOCTYPE html><html lang="en" itemscope itemtype="http://schema.org/Article"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="manifest" href="/manifest.json"><link rel="mask-icon" href="/safari-pinned-tab.svg"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/assets/css/bootstrap.min.css" type="text/css"><link href="/assets/css/highlight.css" rel="stylesheet"><link href="/assets/css/main.css" rel="stylesheet"><link href="/assets/css/share.css" rel="stylesheet"><link href="/assets/css/slick.css" rel="stylesheet"><link href="/assets/css/custom.css" rel="stylesheet"><link href="/assets/css/mobile.css" rel="stylesheet" type="text/css" media="only screen and (max-width: 480px)" /><link href="/assets/css/desktop.css" rel="stylesheet" type="text/css" media="only screen and (min-width: 480px)" /><title>The CIA Rule Book on Malware Creation | Hacking Tutorials by Xeus</title><meta name="description" content="From the CIA leaks published by WikiLeaks, here is the secret to CIA's offensive security approach. Let's learn how the CIA makes malware." /><link rel="canonical" href="http://xeushack.com/the-CIA-rule-book-on-malware-creation"><meta itemprop="name" content="The CIA Rule Book on Malware Creation"><meta itemprop="description" content="From the CIA leaks published by WikiLeaks, here is the secret to CIA's offensive security approach. Let's learn how the CIA makes malware." /><meta itemprop="image" content="http://xeushack.com/assets/img/posts/the-CIA-rule-book-on-malware-creation/header.jpeg"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="The CIA Rule Book on Malware Creation"><meta property="og:url" content="http://xeushack.com/the-CIA-rule-book-on-malware-creation"><meta property="og:image" content="http://xeushack.com/assets/img/posts/the-CIA-rule-book-on-malware-creation/header.jpeg" /><meta property="og:site_name" content="Hacking Tutorials by Xeus"><meta property="article:publisher" content="https://www.facebook.com/XeusHack/" /><meta property="article:author" content="https://www.facebook.com/XeusHack/" /><meta property="article:published_time" content="2017-03-07 06:39:25 +0530" /><meta property="og:description" content="From the CIA leaks published by WikiLeaks, here is the secret to CIA's offensive security approach. Let's learn how the CIA makes malware."><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="The CIA Rule Book on Malware Creation"><meta name="twitter:description" content="From the CIA leaks published by WikiLeaks, here is the secret to CIA's offensive security approach. Let's learn how the CIA makes malware."><meta name="twitter:image" content="http://xeushack.com/assets/img/posts/the-CIA-rule-book-on-malware-creation/header.jpeg"><meta name="twitter:site" content="@xeus_hack" /><meta name="twitter:creator" content="@xeus_hack"></head><body id="page-top"><nav class="slidemenu" id="slidemenu"><div class="nav-drawer hidden"><ul class="menu-section-list"><li><a href="/">Home</a></li><li><a href="/recent">Recent</a></li></ul><div class="nav-drawer-social"><div class="patreon_msg"><a class="post-patreon-button" href="https://patreon.com/Xeus"> <svg width="20" height="20" viewBox="7.846 7.798 47.363 47.34"><path fill="#fff" d="M7.846 30.818c0-11.027 8.96-21.366 20.775-22.843 8.468-.985 14.868 2.265 19.298 6.498 4.135 3.938 6.598 8.96 7.188 14.868.492 5.907-.787 11.027-4.233 15.852-3.446 4.727-10.24 9.945-18.708 9.945h-11.52V32.394c.099-5.022 1.772-9.354 7.877-11.422 5.317-1.575 11.52 1.378 13.391 6.991 1.969 6.006-.887 10.043-4.234 12.505s-8.566 2.462-12.012.099v7.778c2.265 1.083 5.12 1.378 7.188 1.28 7.482-1.084 13.292-5.317 15.754-11.717 2.561-6.794.787-14.671-4.529-19.594-6.4-5.219-13.391-6.499-20.874-2.855-5.218 2.659-8.861 8.074-9.748 13.981v25.699H7.945l-.099-24.321z"/></svg> Become a patron</a></div><hr><p class="nav-drawer-social-message"> Don't get left behind! <strong>Follow Xeus</strong> to get the latest in hacking.</p><a class= "nav-drawer-social-button" href="https://twitter.com/xeus_hack"> <svg class="nav-drawer-social-icon" width="60" height="60" viewBox="0 0 25 25"><path fill="#fff" d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path> </svg> </a> <a class= "nav-drawer-social-button" href="https://facebook.com/XeusHack"> <svg class="nav-drawer-social-icon" width="60" height="60" viewBox="0 0 25 25"><path fill="#fff" d="M17,2V2H17V6H15C14.31,6 14,6.81 14,7.5V10H14L17,10V14H14V22H10V14H7V10H10V6A4,4 0 0,1 14,2H17Z" /> </svg> </a> <a class= "nav-drawer-social-button" href="https://plus.google.com/108499592940088025693"> <svg class="nav-drawer-social-icon" width="60" height="60" viewBox="0 0 24 24"><path fill="#fff" d="M23,11H21V9H19V11H17V13H19V15H21V13H23M8,11V13.4H12C11.8,14.4 10.8,16.4 8,16.4C5.6,16.4 3.7,14.4 3.7,12C3.7,9.6 5.6,7.6 8,7.6C9.4,7.6 10.3,8.2 10.8,8.7L12.7,6.9C11.5,5.7 9.9,5 8,5C4.1,5 1,8.1 1,12C1,15.9 4.1,19 8,19C12,19 14.7,16.2 14.7,12.2C14.7,11.7 14.7,11.4 14.6,11H8Z" /> </svg> </a> <a class= "nav-drawer-social-button" href="https://www.instagram.com/xeus_hack"> <svg class="nav-drawer-social-icon" width="60" height="60" viewBox="0 0 24 24"><path fill="#fff" d="M7.8,2H16.2C19.4,2 22,4.6 22,7.8V16.2A5.8,5.8 0 0,1 16.2,22H7.8C4.6,22 2,19.4 2,16.2V7.8A5.8,5.8 0 0,1 7.8,2M7.6,4A3.6,3.6 0 0,0 4,7.6V16.4C4,18.39 5.61,20 7.6,20H16.4A3.6,3.6 0 0,0 20,16.4V7.6C20,5.61 18.39,4 16.4,4H7.6M17.25,5.5A1.25,1.25 0 0,1 18.5,6.75A1.25,1.25 0 0,1 17.25,8A1.25,1.25 0 0,1 16,6.75A1.25,1.25 0 0,1 17.25,5.5M12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z" /> </svg> </a></div></div></nav><div class="header-wrapper"><header id="mainNav" class="slide-header fixed-header"> <button class="menu-button toggle-button colorchanger"> <svg class = "menu-button-svg" viewBox="0 0 24 24"><path fill="#ffffff" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /> </svg> </button> <a class="navbar-brand page-scroll colorchanger" href="/">XeusHack</a> <button class="menu-button menu-button-scroll colorchanger "> <svg class = "menu-button-svg" viewBox="0 0 24 24"><path class="menu-scroll-button-stop hidden" fill="#ffffff" d="M18,18H6V6H18V18Z" /><path class="menu-scroll-button-play" fill="#ffffff" d="M8,5.14V19.14L19,12.14L8,5.14Z" /> </svg> </button></header></div><main id="mainpanel"><div class="highlightMenu"><div class="highlightMenu-inner"><div class="buttonSet"> <a data-href="https://twitter.com/intent/tweet?url=http://xeushack.com/the-CIA-rule-book-on-malware-creation&hashtags=XeusHack" class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu is-touched buttonTwitter" rel="nofollow" target="_blank"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span> </a> <a href="http://www.facebook.com/sharer.php?u=http://xeushack.com/the-CIA-rule-book-on-malware-creation" class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu is-touched" rel="nofollow" target="_blank"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M17,2V2H17V6H15C14.31,6 14,6.81 14,7.5V10H14L17,10V14H14V22H10V14H7V10H10V6A4,4 0 0,1 14,2H17Z" /></svg></span> </a></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div><div class="black"><header id="header" class="intro-header bg-primary text-center" style="background-image: linear-gradient( rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3) ), url(/assets/img/posts/the-CIA-rule-book-on-malware-creation/header.jpeg); "><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1>The CIA Rule Book on Malware Creation</h1><h2 class="subheading">It's all out in the open now</h2><p class="meta">March 7, 2017 | 67.8k views</p><a href="#post" class="page-scroll"> <svg style="width:36px;height:36px" viewBox="0 0 24 24"><path fill="#e74c3c" d="M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z" /> </svg> </a></div></div></div></div></header></div><article><div id="post" class="container post-container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="nc_socialPanel swp_flatFresh swp_d_fullColor swp_i_fullColor swp_o_lightGray scale-100 scale-fullWidth"><div class="nc_tweetContainer googlePlus"><a rel="nofollow" target="_blank" href="https://plus.google.com/share?url=http://xeushack.com/the-CIA-rule-book-on-malware-creation" class="nc_tweet"><span class="iconFiller"><span class="spaceManWilly"><i class="sw sw-google-plus"></i><span class="swp_share">+1</span></span></span><span class="swp_count"> 112 </span></a></div><div class="nc_tweetContainer nc_pinterest"><a rel="nofollow" href="https://pinterest.com/pin/create/bookmarklet/?media=&url=http://xeushack.com/the-CIA-rule-book-on-malware-creation" class="nc_tweet"><span class="iconFiller"><span class="spaceManWilly"><i class="sw sw-pinterest"></i><span class="swp_share">Pin</span></span></span><span class="swp_count"> 72 </span></a></div><div class="nc_tweetContainer twitter"><a rel="nofollow" target="_blank" href="https://twitter.com/intent/tweet?url=http://xeushack.com/the-CIA-rule-book-on-malware-creation&text=The%20CIA%20Rule%20Book%20on%20Malware%20Creation&hashtags=XeusHack" class="nc_tweet"><span class="iconFiller"><span class="spaceManWilly"><i class="sw sw-twitter"></i><span class="swp_share"> Tweet</span></span></span><span class="swp_count"> 168</span></a></div><div class="nc_tweetContainer swp_fb"><a rel="nofollow" target="_blank" href="http://www.facebook.com/sharer.php?u=http://xeushack.com/the-CIA-rule-book-on-malware-creation" class="nc_tweet"><span class="iconFiller"><span class="spaceManWilly"><i class="sw sw-facebook"></i><span class="swp_share">Share</span></span></span><span class="swp_count"> 321</span></a></div><div class="nc_tweetContainer swp_reddit"><a rel="nofollow" target="_blank" href="https://reddit.com/submit?url=http://xeushack.com/the-CIA-rule-book-on-malware-creation&title=The%20CIA%20Rule%20Book%20on%20Malware%20Creation" class="nc_tweet"><span class="iconFiller"><span class="spaceManWilly"><i class="sw sw-reddit"></i><span class="swp_share">Reddit</span></span></span><span class="swp_count"> 319</span></a></div><div class="nc_tweetContainer totes totesalt"><span class="swp_count"><span class="swp_label">Shares</span> 992 </span></div></div><div id="post_content"><p>On 7th March 2017, WikiLeaks began releasing a series of leaks on the U.S. Central Intelligence Agency. <span class="shareable">The tools of state sponsored cyber warfare of the highest level are no longer a secret</span>.</p><p>You can read about the full details of the leak <a href="https://wikileaks.org/ciav7p1/">here</a>.</p><p>Within the treasure trove of the disclosed information are some brief technical guidelines, rules for the production of malware. We’re going to take a look at exactly how the CIA builds state-of-the-art viruses and trojans. Their approach, outlined below, takes every possible precaution in the hopes of avoiding fingerprinting and hence preventing the detection of their clandestine activities. <span class="shareable">Let’s see how deep the rabbit hole goes</span>…</p><h2 id="general-rules-for-all-malware">General Rules For All Malware</h2><h3 id="1-obfuscateencrypt">1. Obfuscate/Encrypt</h3><p>DO obfuscate or encrypt all strings and configuration data that directly relate to tool functionality. Consideration should be made to also only de-obfuscating strings in-memory at the moment the data is needed. When a previously de-obfuscated value is no longer needed, it should be wiped from memory.</p><p><strong>Rationale:</strong> String data and/or configuration data is very useful to analysts and reverse-engineers.</p><h3 id="2-delay-de-obfuscationdecryption">2. Delay De-Obfuscation/Decryption</h3><p>DO NOT decrypt or de-obfuscate all string data or configuration data immediately upon execution.</p><p><strong>Rationale:</strong> Raises the difficulty for automated dynamic analysis of the binary to find sensitive data.</p><h3 id="3-clean-up-your-mess">3. Clean up your mess</h3><p>DO explicitly remove sensitive data (encryption keys, raw collection data, shellcode, uploaded modules, etc) from memory as soon as the data is no longer needed in plain-text form.</p><p>DO NOT rely on the operating system to do this upon termination of execution.</p><p><strong>Rationale:</strong> Raises the difficulty for incident response and forensics review.</p><h3 id="4-obfuscate-differently-every-time">4. Obfuscate differently every time</h3><p>DO utilize a deployment-time unique key for obfuscation/de-obfuscation of sensitive strings and configuration data.</p><p><strong>Rationale:</strong> Raises the difficulty of analysis of multiple deployments of the same tool.</p><h3 id="5-leave-no-trace">5. Leave no trace</h3><p>DO strip all debug symbol information, manifests, build paths, developer usernames from the final build of a binary.</p><p><strong>Rationale:</strong> Raises the difficulty for analysis and reverse-engineering, and removes artifacts used for attribution/origination.</p><h3 id="6-get-rid-of-all-the-debugging-stuff">6. Get rid of all the debugging stuff</h3><p>DO strip all debugging output (e.g. calls to printf(), OutputDebugString(), etc) from the final build of a tool.</p><p><strong>Rationale:</strong> Raises the difficulty for analysis and reverse-engineering.</p><h3 id="7-keep-your-secrets-hidden">7. Keep your secrets hidden</h3><p>DO NOT explicitly import/call functions that is not consistent with a tool’s overt functionality (i.e. WriteProcessMemory, VirtualAlloc, CreateRemoteThread, etc - for binary that is supposed to be a notepad replacement).</p><p><strong>Rationale:</strong> Lowers potential scrutiny of binary and slightly raises the difficulty for static analysis and reverse-engineering.</p><h3 id="8be-mindful-of-all-exported-data">8.Be mindful of all exported data</h3><p>DO NOT export sensitive function names; if having exports are required for the binary, utilize an ordinal or a benign function name.</p><p><strong>Rationale:</strong> Raises the difficulty for analysis and reverse-engineering.</p><h3 id="9-dont-show-any-weakness">9. Don’t show any weakness</h3><p>DO NOT generate crashdump files, coredump files, “Blue” screens, Dr Watson or other dialog pop-ups and/or other artifacts in the event of a program crash.</p><p>DO attempt to force a program crash during unit testing in order to properly verify this.</p><p><strong>Rationale:</strong> Avoids suspicion by the end user and system admins, and raises the difficulty for incident response and reverse-engineering.</p><h3 id="10-hide-in-plain-sight">10. Hide in plain sight</h3><p>DO NOT perform operations that will cause the target computer to be unresponsive to the user (e.g. CPU spikes, screen flashes, screen “freezing”, etc).</p><p><strong>Rationale:</strong> Avoids unwanted attention from the user or system administrator to tool’s existence and behavior.</p><h3 id="11-minify-everything">11. Minify everything</h3><p>DO make all reasonable efforts to minimize binary file size for all binaries that will be uploaded to a remote target (without the use of packers or compression). Ideal binary file sizes should be under 150KB for a fully featured tool.</p><p><strong>Rationale:</strong> Shortens overall “time on air” not only to get the tool on target, but also the time to execute functionality and clean-up.</p><h3 id="12-document-everything">12. Document everything</h3><p>DO provide a means to completely “uninstall”/”remove” implants, function hooks, injected threads, dropped files, registry keys, services, forked processes, etc whenever possible. Explicitly document (even if the documentation is “There is no uninstall for this <feature>") the procedures, permissions required and side effects of removal.</feature></p><p><strong>Rationale:</strong> Avoids unwanted data left on target. Also, proper documentation allows operators to make better operational risk assessment and fully understand the implications of using a tool or specific feature of a tool.</p><h3 id="12-be-loyal">12. Be loyal</h3><p>DO NOT leave dates/times such as compile timestamps, linker timestamps, build times, access times, etc. that correlate to general US core working hours (i.e. 8am-6pm Eastern time).</p><p><strong>Rationale:</strong> Avoids direct correlation to origination in the United States.</p><h3 id="13-avoid-being-blamed">13. Avoid being blamed</h3><p>DO NOT leave data in a binary file that demonstrates CIA, USG, or its witting partner companies involvement in the creation or use of the binary/tool.</p><p><strong>Rationale:</strong> Attribution of binary/tool/etc by an adversary can cause irreversible impacts to past, present and future US government operations and equities.</p><h3 id="13-seriously-be-loyal">13. Seriously. Be loyal.</h3><p>DO NOT have data that contains CIA and US government cover terms, compartments, operation code names or other CIA and US government specific terminology in the binary.</p><p><strong>Rationale:</strong> Attribution of binary/tool/etc by an adversary can cause irreversible impacts to past, present and future US government operations and equities.</p><h3 id="14-mind-your-language">14. Mind your language</h3><p>DO NOT have “dirty words” in the binary.</p><p><strong>Rationale:</strong> Dirty words, such as hacker terms, common shorthands may cause unwarranted scrutiny of the binary file in question.</p><hr /><h2 id="rules-for-networking">Rules for Networking</h2><h3 id="1-encrypt-every-connection">1. Encrypt every connection</h3><p>DO use end-to-end encryption for all network communications.</p><p>NEVER use networking protocols which break the end-to-end principle with respect to encryption of payloads.</p><p><strong>Rationale:</strong> Stifles network traffic analysis and avoids exposing operational/collection data.</p><h3 id="2-dont-slack-off">2. Don’t slack off</h3><p>DO NOT solely rely on SSL/TLS to secure data in transit.</p><p><strong>Rationale:</strong> Numerous man-in-middle attack vectors and publicly disclosed flaws in the protocol.</p><h3 id="3-once-is-enough">3. Once is enough</h3><p>DO NOT allow network traffic to be re-playable.</p><p><strong>Rationale:</strong> Protects the integrity of operational equities.</p><h3 id="4-stick-to-the-standards">4. Stick to the standards</h3><p>DO use ITEF RFC compliant network protocols as a blending layer. The actual data, which must be encrypted in transit across the network, should be tunneled through a well known and standardized protocol (e.g. HTTPS)</p><p><strong>Rationale:</strong> Custom protocols can stand-out to network analysts and IDS filters.</p><h3 id="5-blend-in">5. Blend in</h3><p>DO NOT break compliance of an RFC protocol that is being used as a blending layer.</p><p>(i.e. Wireshark should not flag the traffic as being broken or mangled)</p><p><strong>Rationale:</strong> Broken network protocols can easily stand-out in IDS filters and network analysis.</p><h3 id="6-chaos-and-confusion-are-your-friends">6. Chaos and Confusion are your friends</h3><p>DO use variable size and timing (aka jitter) of beacons/network communications. DO NOT predicatively send packets with a fixed size and timing.</p><p><strong>Rationale:</strong> Raises the difficulty of network analysis and correlation of network activity.</p><h3 id="7-cover-your-tracks">7. Cover your tracks</h3><p>DO proper cleanup of network connections. DO NOT leave around stale network connections.</p><p><strong>Rationale:</strong> Raises the difficulty of network analysis and incident response.</p><hr /><h2 id="rules-for-disk-io">Rules for Disk I/O</h2><h3 id="1-know-thy-malware">1. Know thy malware</h3><p>DO explicitly document the “disk forensic footprint” that could be potentially created by various features of a binary/tool on a remote target.</p><p><strong>Rationale:</strong> Enables better operational risk assessments with knowledge of potential file system forensic artifacts.</p><h3 id="2-act-only-when-necessary">2. Act only when necessary</h3><p>DO NOT read, write and/or cache data to disk unnecessarily. Be cognizant of 3rd party code that may implicitly write/cache data to disk.</p><p><strong>Rationale:</strong> Lowers potential for forensic artifacts and potential signatures.</p><h3 id="3-plaintext-is-a-mortal-sin">3. Plaintext is a mortal sin</h3><p>DO NOT write plain-text collection data to disk. <strong>Rationale:</strong> Raises difficulty of incident response and forensic analysis.</p><h3 id="4-doesnt-matter-what-it-is-hide-it">4. Doesn’t matter what it is, hide it.</h3><p>DO encrypt all data written to disk.</p><p><strong>Rationale:</strong> Disguises intent of file (collection, sensitive code, etc) and raises difficulty of forensic analysis and incident response.</p><h3 id="5-prevent-recovery">5. Prevent recovery</h3><p>DO utilize a secure erase when removing a file from disk that wipes at a minimum the file’s filename, datetime stamps (create, modify and access) and its content.</p><p>Note: The definition of “secure erase” varies from filesystem to filesystem, but at least a single pass of zeros of the data should be performed. The emphasis here is on removing all filesystem artifacts that could be useful during forensic analysis</p><p><strong>Rationale:</strong> Raises difficulty of incident response and forensic analysis.</p><h3 id="6-stay-in-the-shadows">6. Stay in the shadows</h3><p>DO NOT perform Disk I/O operations that will cause the system to become unresponsive to the user or alerting to a System Administrator.</p><p><strong>Rationale:</strong> Avoids unwanted attention from the user or system administrator to tool’s existence and behavior.</p><h3 id="7-dont-leave-any-signs">7. Don’t leave any signs</h3><p>DO NOT use a “magic header/footer” for encrypted files written to disk. All encrypted files should be completely opaque data files. <strong>Rationale:</strong> Avoids signature of custom file format’s magic values.</p><h3 id="8-be-a-team-player">8. Be a team player</h3><p>DO NOT use hard-coded filenames or filepaths when writing files to disk. This must be configurable at deployment time by the operator.</p><p><strong>Rationale:</strong> Allows operator to choose the proper filename that fits with in the operational target.</p><h3 id="9-stay-in-your-lane">9. Stay in your lane</h3><p>DO have a configurable maximum size limit and/or output file count for writing encrypted output files.</p><p><strong>Rationale:</strong> Avoids situations where a collection task can get out of control and fills the target’s disk; which will draw unwanted attention to the tool and/or the operation.</p><hr /><h2 id="dealing-with-dates-or-time">Dealing with Dates or Time</h2><h3 id="1-stay-consistent">1. Stay consistent</h3><p>DO use GMT/UTC/Zulu as the time zone when comparing date/time.</p><p><strong>Rationale:</strong> Provides consistent behavior and helps ensure “triggers/beacons/etc” fire when expected.</p><h3 id="2-you-didnt-forget-about-loyalty-did-you">2. You didn’t forget about loyalty, did you?</h3><p>DO NOT use US-centric timestamp formats such as MM-DD-YYYY. YYYYMMDD is generally preferred.</p><p><strong>Rationale:</strong> Maintains consistency across tools, and avoids associations with the United States.</p><hr /><p>So there you have it. <span class="shareable">The source of this leak has risked their life to release this information</span>. From a statement to WikiLeaks, the source wishes to initiate a public debate about the security, creation, use, proliferation and democratic control of cyberweapons.</p><p>State sponsored agencies around world, not just the CIA, operate outside the bounds of the law with little oversight and a blank cheque. This leak has conclusively proven that the most powerful blackhats are the ones meant to be protecting us. The source is asking you - <strong>Are you okay with this?</strong></p></div><div class ="bottom-social-buttons"><div class="google"> <g:plusone></g:plusone></div><iframe src="https://www.facebook.com/plugins/like.php?href=http://xeushack.com/the-CIA-rule-book-on-malware-creation&width=118&layout=button&action=like&size=small&show_faces=false&share=true&height=46&appId" width="100" height="24" style="border:none;overflow:hidden"></iframe> &nbsp;</div><br/><div id ="tags"><p> <svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="#444" d="M5.5,9A1.5,1.5 0 0,0 7,7.5A1.5,1.5 0 0,0 5.5,6A1.5,1.5 0 0,0 4,7.5A1.5,1.5 0 0,0 5.5,9M17.41,11.58C17.77,11.94 18,12.44 18,13C18,13.55 17.78,14.05 17.41,14.41L12.41,19.41C12.05,19.77 11.55,20 11,20C10.45,20 9.95,19.78 9.58,19.41L2.59,12.42C2.22,12.05 2,11.55 2,11V6C2,4.89 2.89,4 4,4H9C9.55,4 10.05,4.22 10.41,4.58L17.41,11.58M13.54,5.71L14.54,4.71L21.41,11.58C21.78,11.94 22,12.45 22,13C22,13.55 21.78,14.05 21.42,14.41L16.04,19.79L15.04,18.79L20.75,13L13.54,5.71Z"> </path> </svg> <a href="/tag/attack">attack</a> , <a href="/tag/virus">virus</a> , <a href="/tag/government">government</a></p></div><br/><div class="patreon_msg"><p>Want to be a real hacker? <a href="/register">Sign Up!</a></p></div><br/> <br/><p class="patreon_msg">Recommended | <a href="/">All</a> | <a href="/recent">New</a> <br/></p></div></div></div></article><br/><div class="row"><div class="col-xs-6 col-md-6 col-sm-6 col-lg-3 small"><div class = "index-item-parent"> <a href="/the-zero-trust-principle"><div class="featured-img"> <img class= "index-thumbnail" src="/assets/img/posts/the-zero-trust-principle/header.jpeg" /><div class="featured-title"><h3 class="post-title">The Zero Trust Principle</h3></div></div></a></div></div><div class="col-xs-6 col-md-6 col-sm-6 col-lg-3 small"><div class = "index-item-parent"> <a href="/best-books-on-privacy-and-government-surveillance"><div class="featured-img"> <img class= "index-thumbnail" src="/assets/img/posts/best-books-on-privacy-and-government-surveillance/header.jpg" /><div class="featured-title"><h3 class="post-title">The Top 5 Books on Privacy and Surveillance</h3></div></div></a></div></div><div class="col-xs-6 col-md-6 col-sm-6 col-lg-3 small"><div class = "index-item-parent"> <a href="/best-books-for-learning-how-to-hack-wifi"><div class="featured-img"> <img class= "index-thumbnail" src="/assets/img/posts/best-books-for-learning-how-to-hack-wifi/header.jpg" /><div class="featured-title"><h3 class="post-title">The Best Books for Learning How to Hack Wi-Fi (2017)</h3></div></div></a></div></div><div class="col-xs-6 col-md-6 col-sm-6 col-lg-3 small"><div class = "index-item-parent"> <a href="/protecting-against-ddos"><div class="featured-img"> <img class= "index-thumbnail" src="/assets/img/posts/protecting-against-ddos/header.jpg" /><div class="featured-title"><h3 class="post-title">Protecting Against DDoS</h3></div></div></a></div></div></div><div id ="footer"><footer><div class="container"><div class="row"><div class="col-sm-6"><h4 class="white-text">Trending</h4><br/><div id="tag-cloud"> <a href="/tag/wifi.html" class="set-1">WiFi</a> <a href="/tag/android.html" class="set-1">android</a> <a href="/tag/attack.html" class="set-5">attack</a> <a href="/tag/batch-file.html" class="set-1">batch-file</a> <a href="/tag/books.html" class="set-1">books</a> <a href="/tag/fun.html" class="set-1">fun</a> <a href="/tag/general.html" class="set-2">general</a> <a href="/tag/government.html" class="set-1">government</a> <a href="/tag/kali.html" class="set-1">kali</a> <a href="/tag/legacy.html" class="set-1">legacy</a> <a href="/tag/linux.html" class="set-1">linux</a> <a href="/tag/metasploit.html" class="set-2">metasploit</a> <a href="/tag/mobile.html" class="set-1">mobile</a> <a href="/tag/networking.html" class="set-3">networking</a> <a href="/tag/online.html" class="set-3">online</a> <a href="/tag/osx.html" class="set-1">osx</a> <a href="/tag/password.html" class="set-2">password</a> <a href="/tag/privacy.html" class="set-2">privacy</a> <a href="/tag/recon.html" class="set-1">recon</a> <a href="/tag/review.html" class="set-1">review</a> <a href="/tag/security.html" class="set-2">security</a> <a href="/tag/social.html" class="set-1">social</a> <a href="/tag/social-engineering.html" class="set-1">social-engineering</a> <a href="/tag/tools.html" class="set-2">tools</a> <a href="/tag/tricks.html" class="set-1">tricks</a> <a href="/tag/virus.html" class="set-2">virus</a> <a href="/tag/windows.html" class="set-2">windows</a></div><br/></div><div class="col-sm-6"><h4 class="white-text">Get the <b>latest</b> content</h4><div id="mc_embed_signup"> <form action="//XeusHack.us14.list-manage.com/subscribe/post?u=6274aec362750fd21cf8c8698&amp;id=d62d1e0f7f" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate><div id="mc_embed_signup_scroll"> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="Email address" required><div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_6274aec362750fd21cf8c8698_d62d1e0f7f" tabindex="-1" value=""></div><div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div></div></form></div></div></div></div><br/> <br/> <br/><div class="footer-copyright"><div class="container"> © 2017 XeusHack.com <br/> <small><i>This website is meant for educational purposes only.</i></small></div></div></footer></div><a href="#top"><div id="go-top" style="display: block;"><span class="hint--top hint--bounce" data-hint="Go to top"><img style="opacity:0.5;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAQAAAAm93DmAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwABJ0cAASdHAQQOxT4AAAH2SURBVEjH7dXLi41hHMDxz5nXMEadIZf00JRpUjPF0MG4xBiysbay0+RSs1AoWZ2FpctCspjBnvwDNkTJuEw6RZgpZkGvJuQgE+OcsTA3M+cWS+e7/j3fenu+z++lSpUq5UlUMpQiQq6/gtmoIt18R23xJPyM/12YIintlF3qPQjfyymj0rLAUmccMdcc7Za7H74F8d8JU9Doov3jUzXWa9YnW0oZldS16LFXAgM+WCyhRZtH3hdXRiV0m1y2DfQ54IY2K7FKu4y3xZRRUd0evdaCmw555p27VmtGsMNLrworo4K6Gvtc0oS867oNgY9uW6FVwhKd3ngRxuLywhRzdDlvOUb1Om6YfrHAF7c0WCeS1OmTTMjHpYUp6hxz2iKMOCst2z/+abFYGHFHwka16u2U83hm7NEMXVLaSfXISjtr5M/nFgs/3PPVZnXm2T479mhKNi1ihp3QY3T2642FnIdiWy0oFHs07V6nIh7S7bp84WUQC2MyBmy2cHbs0aRuKuJnDrtJ8d0SC7yUsdGymbFHBSI+6H4p3aRySN/s2KMU7HbFGkxErPzmiwXiabF3eO51UAOaNCLvmi6DlegYnxrU5Zo8GjVBFAs8VWuDqxMRV8pk7Au1OueCXP/vX0CKpA53ZSuXTZGiwQ53fP6b01Wq/J/8AoWqpexekIXXAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTEyLTI0VDE1OjAxOjU5KzAxOjAwE3DxMQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0xMi0yNFQxNTowMTo1OSswMTowMGItSY0AAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC" width="40" height="40" alt="go to top"></span></div></a></main><script src="/assets/js/combined.js"></script> <script src="/assets/js/custom.js"></script> <script src="https://apis.google.com/js/platform.js" async defer></script> <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false" async defer></script></body></html>
